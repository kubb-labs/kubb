name: Sync AGENTS.md from Skills

on:
  push:
    paths:
      - ".skills/**"
  pull_request:
    paths:
      - ".skills/**"
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write

jobs:
  build-agents-md:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Generate skills block
        uses: dave1010/skills-to-agents@v1
        with:
          repo-root: .
          skills-dir: .skills
          agents-path: AGENTS.md
      - uses: peter-evans/create-pull-request@v7
        if: steps.build.outputs.changed == 'true'
        with:
          branch: chore/update-agents
          title: "Update AGENTS.md"
          commit-message: "chore(agents): update AGENTS.md"
          body: "Automated update of AGENTS.md from skills."
